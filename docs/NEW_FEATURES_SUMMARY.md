# ğŸ‰ æ–°åŠŸèƒ½æ€»ç»“ - é‚®ä»¶æ‰¹é‡å‘é€ä¸ç¼“å­˜ç³»ç»Ÿ

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°å®ç°äº†ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ï¼š

### 1ï¸âƒ£ é‚®ä»¶å†…å®¹ç¼“å­˜ç³»ç»Ÿ
å°†æŠ¥å‘Šç”Ÿæˆå’Œé‚®ä»¶å‘é€è§£è€¦ï¼Œæ”¯æŒç‹¬ç«‹æ“ä½œã€‚

### 2ï¸âƒ£ æ‰¹é‡é‚®ä»¶å‘é€
æ”¯æŒåŒæ—¶å‘å¤šä¸ªæ”¶ä»¶äººå‘é€æŠ¥å‘Šï¼Œæä¾›çµæ´»çš„é…ç½®æ–¹å¼ã€‚

---

## ğŸ†• æ–°å¢åŠŸèƒ½è¯¦è§£

### åŠŸèƒ½ 1ï¼šé‚®ä»¶ç¼“å­˜ç³»ç»Ÿ

#### ğŸ“Œ æ ¸å¿ƒæ”¹è¿›
- `run_daily_report.py` ç°åœ¨åªç”ŸæˆæŠ¥å‘Šå¹¶ä¿å­˜åˆ°ç¼“å­˜
- æ–°å¢ `send_cached_report.py` è„šæœ¬ä¸“é—¨è´Ÿè´£å‘é€é‚®ä»¶
- ç¼“å­˜æ–‡ä»¶ä¿å­˜åœ¨ `models/email_cache.json`

#### ğŸ’¡ ä½¿ç”¨æ–¹æ³•

```bash
# æ­¥éª¤ 1ï¼šç”ŸæˆæŠ¥å‘Šï¼ˆè‡ªåŠ¨ç¼“å­˜ï¼‰
python run_daily_report.py

# æ­¥éª¤ 2ï¼šé¢„è§ˆé‚®ä»¶å†…å®¹
python send_cached_report.py --preview

# æ­¥éª¤ 3ï¼šç¡®è®¤åå‘é€
python send_cached_report.py
```

#### âœ¨ ä¼˜åŠ¿
- âœ… **çµæ´»æ€§**ï¼šå¯ä»¥å…ˆç”ŸæˆæŠ¥å‘Šï¼Œç¨åå†å†³å®šæ˜¯å¦å‘é€
- âœ… **å¯é æ€§**ï¼šå³ä½¿é‚®ä»¶å‘é€å¤±è´¥ï¼Œä¹Ÿä¸éœ€è¦é‡æ–°ç”ŸæˆæŠ¥å‘Š
- âœ… **å¯æµ‹è¯•**ï¼šå¯ä»¥é¢„è§ˆé‚®ä»¶å†…å®¹ï¼Œç¡®è®¤æ— è¯¯åå†å‘é€
- âœ… **å¯é‡å‘**ï¼šæ”¯æŒä»å†å²ç¼“å­˜é‡æ–°å‘é€æ—§æŠ¥å‘Š

---

### åŠŸèƒ½ 2ï¼šæ‰¹é‡é‚®ä»¶å‘é€

#### ğŸ“Œ æ ¸å¿ƒåŠŸèƒ½
- æ”¯æŒé…ç½®æ–‡ä»¶æ–¹å¼æŒ‡å®šå¤šä¸ªæ”¶ä»¶äºº
- æ”¯æŒå‘½ä»¤è¡Œæ–¹å¼åŠ¨æ€æŒ‡å®šæ”¶ä»¶äºº
- å‘½ä»¤è¡Œå‚æ•°å¯è¦†ç›–é…ç½®æ–‡ä»¶è®¾ç½®

#### ğŸ’¡ ä½¿ç”¨æ–¹æ³•

**æ–¹å¼ Aï¼šé…ç½®æ–‡ä»¶ï¼ˆæ¨èç”¨äºå›ºå®šæ”¶ä»¶äººï¼‰**

ç¼–è¾‘ `email_config.json`ï¼š
```json
{
  "smtp_server": "smtp.qq.com",
  "smtp_port": 587,
  "use_tls": true,
  "username": "your_email@qq.com",
  "password": "your_password",
  "from_address": "your_email@qq.com",
  "to_address": [
    "recipient1@example.com",
    "recipient2@example.com",
    "recipient3@example.com"
  ]
}
```

å‘é€ï¼š
```bash
python send_cached_report.py
```

**æ–¹å¼ Bï¼šå‘½ä»¤è¡Œï¼ˆæ¨èç”¨äºä¸´æ—¶å‘é€ï¼‰**

```bash
# å•ä¸ªæ”¶ä»¶äºº
python send_cached_report.py --to someone@example.com

# å¤šä¸ªæ”¶ä»¶äºº
python send_cached_report.py --to email1@example.com email2@example.com email3@example.com
```

#### âœ¨ ä¼˜åŠ¿
- âœ… **æ‰¹é‡å‘é€**ï¼šä¸€æ¬¡æ€§å‘é€ç»™å¤šä¸ªæ”¶ä»¶äºº
- âœ… **çµæ´»é…ç½®**ï¼šæ”¯æŒé…ç½®æ–‡ä»¶å’Œå‘½ä»¤è¡Œä¸¤ç§æ–¹å¼
- âœ… **åˆ†ç»„ç®¡ç†**ï¼šå¯åˆ›å»ºå¤šä¸ªé…ç½®æ–‡ä»¶ç®¡ç†ä¸åŒæ”¶ä»¶äººç»„
- âœ… **ä¸´æ—¶è°ƒæ•´**ï¼šå‘½ä»¤è¡Œå‚æ•°å¯ä¸´æ—¶è¦†ç›–é…ç½®

---

## ğŸ“‚ æ–°å¢æ–‡ä»¶

### 1. `send_cached_report.py`
ç‹¬ç«‹çš„é‚®ä»¶å‘é€è„šæœ¬ï¼Œæ”¯æŒï¼š
- ä»ç¼“å­˜è¯»å–é‚®ä»¶å†…å®¹
- é¢„è§ˆé‚®ä»¶å†…å®¹
- æ‰¹é‡å‘é€
- è‡ªå®šä¹‰æ”¶ä»¶äºº

### 2. `docs/email_caching_workflow.md`
é‚®ä»¶ç¼“å­˜ç³»ç»Ÿçš„å®Œæ•´ä½¿ç”¨æŒ‡å—

### 3. `docs/batch_email_guide.md`
æ‰¹é‡å‘é€åŠŸèƒ½çš„è¯¦ç»†æ–‡æ¡£

### 4. `docs/QUICK_REFERENCE.md`
å¿«é€Ÿå‚è€ƒæŒ‡å—ï¼ŒåŒ…å«å¸¸ç”¨å‘½ä»¤å’Œç¤ºä¾‹

---

## ğŸ”„ ä¿®æ”¹çš„æ–‡ä»¶

### 1. `run_daily_report.py`
- âœï¸ ç§»é™¤äº†é‚®ä»¶å‘é€åŠŸèƒ½
- â• æ·»åŠ äº†é‚®ä»¶å†…å®¹ç¼“å­˜åŠŸèƒ½
- ğŸ’¾ ç”Ÿæˆçš„ç¼“å­˜ä¿å­˜åœ¨ `models/email_cache.json`

### 2. `src/email_sender.py`
- â• æ·»åŠ äº† `to_addresses` å‚æ•°
- âœ¨ æ”¯æŒå•ä¸ªæˆ–å¤šä¸ªæ”¶ä»¶äºº
- ğŸ”§ æ”¹è¿›äº†é”™è¯¯å¤„ç†

### 3. `email_config.json`
- â• æ·»åŠ äº†æ‰¹é‡å‘é€ç¤ºä¾‹
- ğŸ“ æ·»åŠ äº†é…ç½®è¯´æ˜æ³¨é‡Š
- æ”¯æŒ `to_address` ä¸ºå­—ç¬¦ä¸²æˆ–æ•°ç»„

---

## ğŸ“– ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šæ—¥å¸¸è‡ªåŠ¨åŒ–æŠ¥å‘Š

```bash
# æ¯å¤©è‡ªåŠ¨è¿è¡Œï¼ˆå¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡ï¼‰
python run_daily_report.py

# ç¨åç¡®è®¤åå‘é€
python send_cached_report.py --preview
python send_cached_report.py
```

**é€‚ç”¨äº**ï¼šéœ€è¦å…ˆå®¡æ ¸æŠ¥å‘Šå†…å®¹çš„æƒ…å†µ

---

### åœºæ™¯ 2ï¼šå¤šä¸ªæ”¶ä»¶äººç¾¤ç»„

**é…ç½®ä¸åŒçš„é‚®ä»¶ç»„ï¼š**

`email_config_team.json`ï¼š
```json
{
  "to_address": ["dev@company.com", "analyst@company.com"]
}
```

`email_config_clients.json`ï¼š
```json
{
  "to_address": ["client1@example.com", "client2@example.com"]
}
```

**å‘é€ï¼š**
```bash
# å‘ç»™å†…éƒ¨å›¢é˜Ÿ
python send_cached_report.py --email-config email_config_team.json

# å‘ç»™å®¢æˆ·
python send_cached_report.py --email-config email_config_clients.json
```

**é€‚ç”¨äº**ï¼šéœ€è¦å‘ä¸åŒç¾¤ä½“å‘é€åŒä¸€ä»½æŠ¥å‘Š

---

### åœºæ™¯ 3ï¼šæµ‹è¯•ä¸ç”Ÿäº§ç¯å¢ƒ

```bash
# 1. ç”ŸæˆæŠ¥å‘Š
python run_daily_report.py

# 2. å…ˆå‘ç»™è‡ªå·±æµ‹è¯•
python send_cached_report.py --to your_test_email@example.com

# 3. ç¡®è®¤æ— è¯¯åå‘ç»™æ‰€æœ‰äºº
python send_cached_report.py
```

**é€‚ç”¨äº**ï¼šéœ€è¦å…ˆæµ‹è¯•é‚®ä»¶æ•ˆæœçš„æƒ…å†µ

---

### åœºæ™¯ 4ï¼šå†å²æŠ¥å‘Šé‡å‘

```bash
# æŸ¥çœ‹å†å²ç¼“å­˜
ls models/email_cache*.json

# é‡å‘æŸä¸ªå†å²æŠ¥å‘Š
python send_cached_report.py --cache models/email_cache_2025-10-01.json --to new_client@example.com
```

**é€‚ç”¨äº**ï¼šéœ€è¦è¡¥å‘å†å²æŠ¥å‘Šç»™æ–°è®¢é˜…è€…

---

## ğŸ¯ å‘½ä»¤è¡Œå‚æ•°å®Œæ•´åˆ—è¡¨

### `send_cached_report.py` å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--cache CACHE` | æŒ‡å®šç¼“å­˜æ–‡ä»¶è·¯å¾„ | `--cache models/old.json` |
| `--preview` | é¢„è§ˆé‚®ä»¶å†…å®¹è€Œä¸å‘é€ | `--preview` |
| `--email-config CONFIG` | æŒ‡å®šé‚®ä»¶é…ç½®æ–‡ä»¶ | `--email-config email_vip.json` |
| `--to EMAIL [EMAIL ...]` | æŒ‡å®šæ”¶ä»¶äººï¼ˆè¦†ç›–é…ç½®æ–‡ä»¶ï¼‰ | `--to email1@example.com email2@example.com` |

### ç»„åˆä½¿ç”¨ç¤ºä¾‹

```bash
# ä»ç‰¹å®šç¼“å­˜é¢„è§ˆ
python send_cached_report.py --cache models/old.json --preview

# ä»ç‰¹å®šç¼“å­˜å‘é€ç»™ç‰¹å®šäºº
python send_cached_report.py --cache models/old.json --to vip@example.com

# ä½¿ç”¨ç‰¹å®šé…ç½®å‘é€ç»™é¢å¤–çš„äºº
python send_cached_report.py --email-config email_team.json --to extra@example.com
```

---

## âš™ï¸ é…ç½®æ–‡ä»¶æ ¼å¼

### `email_config.json` æ ¼å¼

```json
{
  "smtp_server": "smtp.example.com",      // SMTPæœåŠ¡å™¨åœ°å€
  "smtp_port": 587,                       // SMTPç«¯å£ï¼ˆ587ç”¨äºTLSï¼Œ465ç”¨äºSSLï¼‰
  "use_tls": true,                        // æ˜¯å¦ä½¿ç”¨TLSåŠ å¯†
  "username": "your_email@example.com",   // é‚®ç®±ç”¨æˆ·å
  "password": "your_password",            // é‚®ç®±å¯†ç æˆ–æˆæƒç 
  "from_address": "your_email@example.com", // å‘ä»¶äººåœ°å€
  "to_address": [                         // æ”¶ä»¶äººåœ°å€ï¼ˆå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ•°ç»„ï¼‰
    "recipient1@example.com",
    "recipient2@example.com"
  ]
}
```

### `email_cache.json` æ ¼å¼

```json
{
  "generated_at": "2025-10-02T12:00:00",
  "date": "2025-10-02",
  "subject": "BUFFå¸‚åœºAIåˆ†ææ—¥æŠ¥ - 2025-10-02",
  "body": "æŠ¥å‘Šæ‘˜è¦å†…å®¹...",
  "attachments": [
    "models/daily_market_report_20251002_120000.png",
    "models/daily_market_report_20251002_120000.pdf",
    "models/next_week_prediction_20251002T120000Z.png"
  ],
  "last_sent_at": "2025-10-02T12:05:00"  // æœ€åå‘é€æ—¶é—´ï¼ˆå‘é€åè‡ªåŠ¨æ·»åŠ ï¼‰
}
```

---

## ğŸ›¡ï¸ æœ€ä½³å®è·µ

### 1. å®‰å…¨æ€§
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆSMTPå¯†ç ï¼‰
- âœ… ä¸è¦å°† `email_config.json` æäº¤åˆ°å…¬å¼€çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- âœ… ä½¿ç”¨é‚®ç®±æˆæƒç è€Œä¸æ˜¯çœŸå®å¯†ç 

### 2. å¯é æ€§
- âœ… å®šæœŸå¤‡ä»½ `email_cache.json`
- âœ… å‘é€å‰ä½¿ç”¨ `--preview` é¢„è§ˆå†…å®¹
- âœ… å…ˆå‘ç»™è‡ªå·±æµ‹è¯•ï¼Œç¡®è®¤æ— è¯¯åå†æ‰¹é‡å‘é€

### 3. æ•ˆç‡
- âœ… ä¸ºä¸åŒæ”¶ä»¶äººç¾¤ç»„åˆ›å»ºä¸åŒçš„é…ç½®æ–‡ä»¶
- âœ… ä½¿ç”¨ Shell è„šæœ¬è‡ªåŠ¨åŒ–æ‰¹é‡å‘é€æµç¨‹
- âœ… åˆ©ç”¨ç¼“å­˜ç³»ç»Ÿé¿å…é‡å¤ç”ŸæˆæŠ¥å‘Š

### 4. ç»´æŠ¤æ€§
- âœ… å®šæœŸæ¸…ç†æ—§çš„ç¼“å­˜æ–‡ä»¶
- âœ… è®°å½•å‘é€å†å²ï¼ˆé€šè¿‡ `last_sent_at` å­—æ®µï¼‰
- âœ… ä¸ºä¸åŒåœºæ™¯åˆ›å»ºæ–‡æ¡£åŒ–çš„å‘é€æµç¨‹

---

## ğŸ“Š å·¥ä½œæµå¯¹æ¯”

### æ—§å·¥ä½œæµ
```
[æ•°æ®è·å–] â†’ [ç‰¹å¾å·¥ç¨‹] â†’ [æ¨¡å‹é¢„æµ‹] â†’ [AIåˆ†æ] â†’ [ç”ŸæˆæŠ¥å‘Š] â†’ [ç›´æ¥å‘é€é‚®ä»¶]
                                                              â†“
                                                         å‘é€å¤±è´¥ = ä¸€åˆ‡é‡æ¥
```

### æ–°å·¥ä½œæµ
```
[æ•°æ®è·å–] â†’ [ç‰¹å¾å·¥ç¨‹] â†’ [æ¨¡å‹é¢„æµ‹] â†’ [AIåˆ†æ] â†’ [ç”ŸæˆæŠ¥å‘Š] â†’ [ä¿å­˜ç¼“å­˜]
                                                              â†“
                                                    [ç‹¬ç«‹çš„é‚®ä»¶å‘é€æµç¨‹]
                                                              â†“
                                          [é¢„è§ˆ] â†’ [ç¡®è®¤] â†’ [æ‰¹é‡å‘é€] â†’ [å¯é‡å‘]
```

---

## ğŸ“ å­¦ä¹ èµ„æº

- ğŸ“– [é‚®ä»¶ç¼“å­˜å·¥ä½œæµè¯¦ç»†æŒ‡å—](./email_caching_workflow.md)
- ğŸ“– [æ‰¹é‡å‘é€å®Œæ•´æ–‡æ¡£](./batch_email_guide.md)
- ğŸ“– [å¿«é€Ÿå‚è€ƒæŒ‡å—](./QUICK_REFERENCE.md)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ¬¡ä½¿ç”¨

```bash
# 1. é…ç½®é‚®ä»¶è®¾ç½®ï¼ˆç¼–è¾‘ email_config.jsonï¼‰
# æ·»åŠ æ‚¨çš„ SMTP é…ç½®å’Œæ”¶ä»¶äººåˆ—è¡¨

# 2. ç”ŸæˆæŠ¥å‘Š
python run_daily_report.py

# 3. é¢„è§ˆé‚®ä»¶
python send_cached_report.py --preview

# 4. å‘é€é‚®ä»¶
python send_cached_report.py
```

### æ—¥å¸¸ä½¿ç”¨

```bash
# æ¯å¤©åªéœ€è¿è¡Œä¸¤ä¸ªå‘½ä»¤
python run_daily_report.py          # ç”ŸæˆæŠ¥å‘Š
python send_cached_report.py        # å‘é€é‚®ä»¶
```

### é«˜çº§ä½¿ç”¨

```bash
# å‘é€ç»™ç‰¹å®šäººå‘˜
python send_cached_report.py --to boss@company.com

# ä½¿ç”¨ä¸åŒé…ç½®
python send_cached_report.py --email-config email_config_vip.json

# é‡å‘å†å²æŠ¥å‘Š
python send_cached_report.py --cache models/email_cache_2025-10-01.json
```

---

## ğŸ’¬ åé¦ˆä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ï¼š
- é¡¹ç›®æ–‡æ¡£ï¼š`docs/` ç›®å½•
- é—®é¢˜è¿½è¸ªï¼šGitHub Issues
- ä½¿ç”¨ç¤ºä¾‹ï¼š`docs/QUICK_REFERENCE.md`

---

**äº«å—æ›´é«˜æ•ˆã€æ›´çµæ´»çš„æŠ¥å‘Šå‘é€ä½“éªŒï¼** ğŸ‰
